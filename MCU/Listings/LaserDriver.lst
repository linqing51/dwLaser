C51 COMPILER V9.57.0.0   LASERDRIVER                                                       03/28/2018 18:21:26 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE LASERDRIVER
OBJECT MODULE PLACED IN .\Objects\LaserDriver.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE App\LaserDriver.c LARGE OPTIMIZE(8,SPEED) REGFILE(.\Objects\c805f540.ORC
                    -) BROWSE INCDIR(.\App;.\Lib;.\Modbus) DEBUG OBJECTEXTEND PRINT(.\Listings\LaserDriver.lst) OBJECT(.\Objects\LaserDriver.
                    -obj)

line level    source

   1          #include "LaserDriver.h"
   2          /*****************************************************************************/
   3          
   4          /*****************************************************************************/
   5          #if CONFIG_LASER_LZW == 1
   6          void setLaserPRR(bool st)
   7          {
   8   1              if(st)
   9   1              {
  10   2                      LZW_PRR = 1;
  11   2              }
  12   1              else
  13   1              {
  14   2                      LZW_PRR = 0;
  15   2              }
  16   1      }
  17          bool getLaserPRR(void)
  18          {
  19   1              return LZW_PRR;
  20   1      }
  21          
  22          
  23          void setLaserEStop(bool st)
  24          {
  25   1              if(st)
  26   1              {
  27   2                      LZW_EST = 1;
  28   2              }
  29   1              else
  30   1              {
  31   2                      LZW_EST = 0;
  32   2              }
  33   1      }
  34          bool getLaserEStop(void)
  35          {
  36   1              return LZW_EST;
  37   1      }
  38          
  39          void setLaserPower(int16_t power)
  40          {
  41   1              uint8_t temp;
  42   1              if(power >= 1000)
  43   1              {
  44   2                      power = 1000;
  45   2              }
  46   1              if(power <= 0)
  47   1              {
  48   2                      power = 0;
  49   2              }
  50   1              temp = (uint8_t)((float)power / 1000.0F * 255.0F);
  51   1              LZW_POWER = temp;
  52   1      //      delayUs(10);
  53   1      //      LZW_LA = 0;
C51 COMPILER V9.57.0.0   LASERDRIVER                                                       03/28/2018 18:21:26 PAGE 2   

  54   1      //      delayUs(10);
  55   1      //      LZW_LA = 1;
  56   1              delayUs(10);
  57   1      }
  58          void setLaserFreq(int16_t freq)
  59          {//设定激光器频率
  60   1              //NULL
  61   1      }
*** WARNING C280 IN LINE 58 OF App\LaserDriver.c: 'freq': unreferenced local variable
  62          void setLaserMasterOscillator(bool st)
  63          {//设定主振荡器
  64   1              if(st)
  65   1              {
  66   2                      LZW_MO = 1;
  67   2              }
  68   1              else
  69   1              {
  70   2                      LZW_MO = 0;
  71   2              }
  72   1      }
  73          void setLaserAmplifier(bool st)
  74          {//设定放大器
  75   1              if(st)
  76   1              {
  77   2                      LZW_PA = 1;
  78   2              }
  79   1              else
  80   1              {
  81   2                      LZW_PA = 0;
  82   2              }
  83   1      }
  84          void setLaserAim(bool st)
  85          {//设定指示激光
  86   1              if(st)
  87   1              {
  88   2                      LZW_AIM = 1;
  89   2              }
  90   1              else
  91   1              {
  92   2                      LZW_AIM = 0;
  93   2              }
  94   1      }
  95          int16_t getLaserMonitorPower(void)
  96          {//获取激光检测功率
  97   1              return 0;
  98   1      }
  99          #endif
 100          
 101          void iniLaser(void)
 102          {//激光器初始化
 103   1      #if CONFIG_LASER_LZW == 1
 104   1              LZW_EST = 0;  
 105   1              LZW_POWER = 0x00;
 106   1              LZW_MO = 0;
 107   1              LZW_PA = 0;
 108   1              LZW_AIM = 0;    
 109   1              LZW_PRR = 0;
 110   1      #endif
 111   1      }
 112          void openLaser(void)
 113          {//打开激光
 114   1      #if CONFIG_LASER_LZW == 1
C51 COMPILER V9.57.0.0   LASERDRIVER                                                       03/28/2018 18:21:26 PAGE 3   

 115   1              LZW_EST = 1;
 116   1              delayUs(20);
 117   1              LZW_MO = 1;
 118   1              delayMs(10);
 119   1              LZW_PA = 1;
 120   1              delayUs(1);
 121   1      #endif
 122   1      }
 123          
 124          void closeLaser(void)
 125          {//关闭激光
 126   1      #if CONFIG_LASER_LZW == 1
 127   1              LZW_POWER = 0;
 128   1              delayUs(20);
 129   1              LZW_PA = 0;//关闭PA
 130   1              delayUs(1);
 131   1              LZW_MO = 0;//关闭MO
 132   1              delayUs(10);
 133   1              LZW_EST = 0;
 134   1      #endif
 135   1      }
 136          
 137          uint8_t getLaserAlarm(void)
 138          {//获取激光器报警信息
 139   1      #if CONFIG_LASER_LZW == 1
 140   1              uint8_t temp;
 141   1              temp = 0;
 142   1              temp |= (uint8_t)LZW_ST0;
 143   1              temp |= ((uint8_t)(LZW_ST1) << 1);
 144   1              return temp;
 145   1      #endif
 146   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    244    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       2
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       5
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
